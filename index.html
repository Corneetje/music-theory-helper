<!DOCTYPE html>
<html>
<body>
    <input type="checkbox" onclick="switchNotation()" name="flat">
    <label for="flat"> Flat notation?</label></br>

    <input type="checkbox" onclick="switchPentatonic()" name="pentatonic">
    <label for="pentatonic"> Pentatonic scales? (Grey means not played)</label></br>

    <input type="checkbox" onclick="switchRelatives()" name="relatives">
    <label for="relatives"> Show relatives?</label></br></br>

    <div id="output"></div>
</body>
<script>
    const sharpKeys = ["C", "C#", "D", "D#", "E", "F", "F#", "G", "G#", "A", "A#", "B"];
    const flatKeys = ["C", "D♭", "D", "E♭", "E", "F", "G♭", "G", "A♭", "A", "B♭", "B"];

    // True being sharp. 
    let notation = true;
    let pentatonic = false; 
    let relatives = false;

    const majorOrder = [2, 2, 1, 2, 2, 2, 1];
    const minorOrder = [2, 1, 2, 2, 1, 2, 2];

    function switchNotation() {
        notation = !notation;
        create();
    }

    function switchPentatonic() {
        pentatonic = !pentatonic;
        create();
    }

    function switchRelatives() {
        relatives = !relatives;
        create();
    }

    function getScales(name, order, keys) {
        let output = [];
        for (let i = 0; i < keys.length; i++) {
            let scale = [];

            let position = 0;
            for (let j = 0; j < order.length; j++) {
                if (i + position >= keys.length) {
                    position -= keys.length;
                }

                scale.push(keys[i + position]);
                position += order[j];
            }

            scale.push(keys[i]);
            output.push(scale);
        }

        return output;
    }

    function generateTable(name, scales) {
        const output = document.getElementById('output');
        const div = document.createElement('div');
        div.style.width = '300px';
        div.style.float = 'left';
        const list = document.createElement("table");

        const caption = document.createElement('caption');
        caption.textContent = name;
        if(pentatonic) {
            caption.textContent += " pentatonic";
        }
        list.append(caption);

        const tr = document.createElement('tr');
        for (let i = 0; i < scales[0].length; i++) {
            const th = document.createElement('th');
            th.textContent = i + 1;
            tr.append(th);
        }
        list.append(tr);

        for (let i = 0; i < scales.length; i++) {
            const tr = document.createElement("tr");

            tr.addEventListener('click', function() {
                const rows = tr.parentElement.getElementsByClassName('row');

                for(let i = 0; i < rows.length; i++) {
                    rows[i].classList.remove('row');
                }
                
                tr.classList.add('row');

                const parentTable = tr.parentElement;
                while(parentTable.children[2].children[0].textContent !== tr.children[0].textContent) {
                    const firstElement = parentTable.children[2];
                    parentTable.appendChild(firstElement);
                }
            })

            for(let j = 0; j < scales[j].length; j++) {
                const td = document.createElement('td');
                td.textContent = scales[i][j];

                if(j === 0) {
                    td.style.fontWeight = 'bold';
                }

                if(pentatonic) {
                    if(name === "Major" && (j + 1 === 4 || j + 1 === 7)) {
                        td.style.backgroundColor = 'lightgrey';
                    } else if(name === "Minor" && (j + 1 === 2 || j + 1 === 6)) {
                        td.style.backgroundColor = 'lightgrey';
                    }
                }

                if(relatives) {
                    // Sixth degree of a major scale is the root of its relative minor.
                    if(name === "Major" && j + 1 === 6) {
                        td.style.backgroundColor = 'lightcoral';
                    } 
                    // Third degree of a minor scale is the root of its relative major.
                    if(name === "Minor" && j + 1 === 3) {
                        td.style.backgroundColor = 'lightcoral';
                    }
                }

                tr.append(td);
            }

            list.append(tr);
        }

        div.append(list); 
        output.append(div);
    }

    function create() {
        document.getElementById('output').innerHTML = '';

        let tempNotation = sharpKeys;
        if(!notation) {
            tempNotation = flatKeys;
        }

        const majorScales = getScales("Major", majorOrder, tempNotation);
        generateTable("Major", majorScales);

        const minorScales = getScales("Minor", minorOrder, tempNotation);
        generateTable("Minor", minorScales);
    }

    create();    
</script>
<style>
    td {
        width: 30px;
    }
    .row {
        background-color: lightgreen;
    }
</style>

</html>